\begin{frame}[fragile,label=checkVTableRet1]{checking a VTable return}
\begin{minipage}{0.5\textwidth}
\begin{lstlisting}[
    language=myasm,style=smaller,
    moredelim={**[is][\btHL<1->]{~1~}{~end~}},
]
example:
  movq (%rdi), %rax
  movq (%rax), %rax
  cmpq $0xe0c5df0b, 2(%rax)
  jne CRASH
  call *%rax
  ~1~label $0x64a0cfe3~end~
  ret
\end{lstlisting}
\end{minipage}
\begin{minipage}{0.5\textwidth}
\begin{lstlisting}[language=myasm,style=smaller,
    moredelim={**[is][\btHL<1->]{~1~}{~end~}},
]
A::bar():
  label $0xe0c5df0b
  ...
  ~1~pop %rdx~end~ // RDX <- return address
  ~1~cmp $0x64a0cfe3, 2(%rdx)~end~
  jne CRASH
  jmp *%rdx
B::bar():
  label $0xe0c5df0b
  ...
  ~1~pop %rdx~end~ // RDX <- return address
  ~1~cmp $0x64a0cfe3, 2(%rdx)~end~
  jne CRASH
  jmp *%rdx
\end{lstlisting}
\end{minipage}
\begin{itemize}
\item if we want to use this label-checking on the return \\
need to choose the same label for A::bar and B::bar return, too
\end{itemize}
\end{frame}
