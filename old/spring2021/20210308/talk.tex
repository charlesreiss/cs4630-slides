\graphicspath{{./figures/}}
\title{stack smashing}
\date{}
\begin{document}
\begin{frame}
    \titlepage
\end{frame}

\begin{frame}{last time}
    \begin{itemize}
    \item antidebugging
        \begin{itemize}
        \item detecting code modifications for breakpoints
        \item timing/etc. operations
        \end{itemize}
    \item emulator/virtualizer-based obfuscation
    \item rootkit-style techniques
        \begin{itemize}
        \item modifying system inspection programs/interfaces
        \item signatures/consistency checks to detect
        \end{itemize}
    \item simple buffer overflows
        \begin{itemize}
        \item one variable happens to be next to another
        \item providing input too big to overwrite value
        \end{itemize}
    \item stack smashing (start)
    \end{itemize}
\end{frame}

\usetikzlibrary{arrows.meta,calc,matrix,positioning}

\section{stack smashing, high-level}
\input{../overflow/smash-context}

\subsection{example of overflow}
\input{../overflow/smash-oflow-ex}

\subsubsection{exercise: stack layout}
\input{../overflow/smash-oflow-ex-stack-layout-exer}

\subsubsection{exercise answer: stack layout}
\input{../overflow/smash-oflow-stack}

\subsubsection{crash, revisited}
\input{../overflow/smash-oflow-crash}

\subsection{return-to-stack}
\input{../overflow/return-to-stack}

\section{constructing return-to-stack}
\input{../overflow/smash-construct-parts}

\subsection{writing shellcode}
\againframe<2>{makeAttack}
\input{../overflow/smash-shellcode}

\input{../overflow/smash-recall-virus} % FIXME: modify to match TRICKY

\input{../overflow/smash-virus-to-shell} % FIXME: modify to match TRICKY (need less here)

\subsection{setting return address}
\againframe<3>{makeAttack}
    % FIXME: diagram showing stack distance
\input{../overflow/smash-set-ret}

\subsubsection{exercise}
\input{../overflow/smash-set-ret-ex}

\subsubsection{exercise (alt)}
\input{../overflow/smash-set-ret-ex-alt}

% FIXME: move stackloc stuff here?
\section{aside on ASLR}
\subsection{actual stack location}
\input{../mitigate/actual-stackloc}

\subsection{without ASLR}
\input{../mitigate/stackloc-no-aslr}

\subsection{ASLR preview}
\input{../mitigate/aslr-preview}

\subsection{still varies without ASLR?}
\input{../overflow/stackloc-vary}


\subsection{how the stack starts on Linux}
\input{../overflow/linux-initial-stack}

\subsubsection{nop sleds}
\input{../overflow/nop-sled}

\input{../overflow/nop-sled-use}

\subsubsection{finding where return address is}
\againframe<4>{makeAttack}
\input{../overflow/ret-addr-guess}

\section{stack smashing demo / debugger tutorial?}
\input{../overflow/gdb-tut}

\section{example: Morris worm stack smashing}
\input{../overflow/morris-worm-smash}


% FIXME: actual demo
\section{restricted characters in shell code}
     %FIXME: add simple example
\input{../overflow/shell-code-restricted}   

\section{restricted characters in pointers}
\input{../overflow/pointer-restricted}

\section{review: tricky parts of stack smashing}
\input{../overflow/stack-smash-tricky}

\section{backup slides}
\begin{frame}{backup slides}
\end{frame}

\subsection{finding stack location?}
\input{../overflow/finding-stackloc}
\end{document}
