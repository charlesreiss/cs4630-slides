### example: 1260 (virus)

:::: {.columns}

::: {.column}

```{.gnuassembler code-line-numbers=true}
    inc %si
    mov $0x0e9b, %ax
    clc
    mov $0x12a, %di
    nop
    mov $0x571, %cx
decrypt:
    xor %cx, (%di)
    sub %dx, %bx
    sub %cx, %bx
    sub %ax, %bx
    nop
    xor %cx, %dx
    xor %ax, (%di)
    ...
```

:::

::: {.column}

```{.gnuassembler code-line-numbers=true}
    mov $0x0a43, %ax
    nop
    mov $0x15a, %di
    sub %dx, %bx
    sub %cx, %bx
    mov $0x571, %cx
    clc
decrypt:
    xor %cx, (%di)
    xor %cx, %dx
    sub %cx, %bx
    nop
    xor %cx, %bx
    xor %ax, (%di)
    ...
```

:::

::::

[adapted from Szor, Listing 7.5]{.mycredit}

### example: 1260 (virus)

:::: {.columns}

::: {.column}

```{.gnuassembler code-line-numbers='1,3,5,8-12'}
    inc %si
    mov $0x0e9b, %ax
    clc
    mov $0x12a, %di
    nop
    mov $0x571, %cx
decrypt:
    xor %cx, (%di)
    sub %dx, %bx
    sub %cx, %bx
    sub %ax, %bx
    nop
    xor %cx, %dx
    xor %ax, (%di)
    ...
```

:::

::: {.column}

```{.gnuassembler code-line-numbers='2,4,5,7,10-13'}
    mov $0x0a43, %ax
    nop
    mov $0x15a, %di
    sub %dx, %bx
    sub %cx, %bx
    mov $0x571, %cx
    clc
decrypt:
    xor %cx, (%di)
    xor %cx, %dx
    sub %cx, %bx
    nop
    xor %cx, %bx
    xor %ax, (%di)
    ...
```

:::

::::

[adapted from Szor, Listing 7.5]{.mycredit}

::: {.myoverbox .fragment}

do-nothing instructions

:::

### example: 1260 (virus)

:::: {.columns}

::: {.column}

```{.gnuassembler code-line-numbers='2'}
    inc %si
    mov $0x0e9b, %ax
    clc
    mov $0x12a, %di
    nop
    mov $0x571, %cx
decrypt:
    xor %cx, (%di)
    sub %dx, %bx
    sub %cx, %bx
    sub %ax, %bx
    nop
    xor %cx, %dx
    xor %ax, (%di)
    ...
```

:::

::: {.column}

```{.gnuassembler code-line-numbers='1'}
    mov $0x0a43, %ax
    nop
    mov $0x15a, %di
    sub %dx, %bx
    sub %cx, %bx
    mov $0x571, %cx
    clc
decrypt:
    xor %cx, (%di)
    xor %cx, %dx
    sub %cx, %bx
    nop
    xor %cx, %bx
    xor %ax, (%di)
    ...
```

:::

::::

[adapted from Szor, Listing 7.5]{.mycredit}

::: {.myoverbox .fragment}

different "decryption" key

:::

