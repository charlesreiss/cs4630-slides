
### example: W95/Memorial 

:::: {.columns}

::: {.column}

```gnuassembler
  mov $0x405000, %ebp
  mov $0x550, %ecx
  lea 0x2e(%ebp), %esi
  add 0x29(%ebp), %ecx
  mov 0x2d(%ebp), %al

decrypt:
  nop
  nop
  xor %al, (%esi)
  inc %esi
  nop
  inc %al
  dec %ecx
  jnz decrypt
```

:::

::: {.column}

```gnuassembler
  mov $0x550, %ecx
  mov $0x13bc000, %ebp
  lea 0x2e(%ebp), %esi
  add 0x29(%ebp), %ecx
  mov 0x2d(%ebp), %al

decrypt:
  nop
  nop
  xor %al, (%esi)
  inc %esi
  nop
  inc %al
  loop decrypt
  ...
  ...
```

:::

::::

::: {.myoverbox .vlow .fragment}

Szor: "96 different decryptor patterns"

:::

[from Szor, Listings 7.3 and 7.4]{.mycredit}


### example: W95/Memorial 

:::: {.columns}

::: {.column}

```{.gnuassembler code-line-numbers=1-2}
  mov $0x405000, %ebp
  mov $0x550, %ecx
  lea 0x2e(%ebp), %esi
  add 0x29(%ebp), %ecx
  mov 0x2d(%ebp), %al

decrypt:
  nop
  nop
  xor %al, (%esi)
  inc %esi
  nop
  inc %al
  dec %ecx
  jnz decrypt
```

:::

::: {.column}

```{.gnuassembler code-line-numbers=1-2}
  mov $0x550, %ecx
  mov $0x13bc000, %ebp
  lea 0x2e(%ebp), %esi
  add 0x29(%ebp), %ecx
  mov 0x2d(%ebp), %al

decrypt:
  nop
  nop
  xor %al, (%esi)
  inc %esi
  nop
  inc %al
  loop decrypt
  ...
  ...
```

:::

::::

::: {.myoverbox .low}

change instruction order; location of decryption key

:::

[from Szor, Listings 7.3 and 7.4]{.mycredit}


### example: W95/Memorial 

:::: {.columns}

::: {.column}

```{.gnuassembler code-line-numbers=14-15}
  mov $0x405000, %ebp
  mov $0x550, %ecx
  lea 0x2e(%ebp), %esi
  add 0x29(%ebp), %ecx
  mov 0x2d(%ebp), %al

decrypt:
  nop
  nop
  xor %al, (%esi)
  inc %esi
  nop
  inc %al
  dec %ecx
  jnz decrypt
```

:::

::: {.column}

```{.gnuassembler code-line-numbers=14}
  mov $0x550, %ecx
  mov $0x13bc000, %ebp
  lea 0x2e(%ebp), %esi
  add 0x29(%ebp), %ecx
  mov 0x2d(%ebp), %al

decrypt:
  nop
  nop
  xor %al, (%esi)
  inc %esi
  nop
  inc %al
  loop decrypt
  ...
  ...
```

:::

::::

::: {.myoverbox}

different variations for loop instructions

:::

[from Szor, Listings 7.3 and 7.4]{.mycredit}

