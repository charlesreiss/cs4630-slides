
### viruses and executable formats 



::: {.r-stack .my-full}
![](/heur-detect/texfig/exec-lib-regularity-viruses-and-executable-formats.figure-1.svg){.fragment .fade-in-then-out fragment-index=1}

![](/heur-detect/texfig/exec-lib-regularity-viruses-and-executable-formats.figure-2.svg){.fragment .fade-in-then-out fragment-index=2}

![](/heur-detect/texfig/exec-lib-regularity-viruses-and-executable-formats.figure-3.svg){.fragment .fade-in-then-out fragment-index=3}

![](/heur-detect/texfig/exec-lib-regularity-viruses-and-executable-formats.figure-4.svg){.fragment .fade-in-then-out fragment-index=4}

![](/heur-detect/texfig/exec-lib-regularity-viruses-and-executable-formats.figure-5.svg){.fragment .fade-in-then-out fragment-index=5}

![](/heur-detect/texfig/exec-lib-regularity-viruses-and-executable-formats.figure-6.svg){.fragment .fade-in-then-out fragment-index=6}


:::


### defeating entry point checking  {.smaller}



* [insert jump in normal code section, set as entry-point]{.fragment fragment-index=2 .custom .myem-only}
* add code to first section instead (perhaps insert new section at beginning)
 

::: {.r-stack}
![](/heur-detect/texfig/exec-lib-regularity-defeating-entry-point-checking.figure-1.svg){.fragment .fade-in-then-out fragment-index=1}

![](/heur-detect/texfig/exec-lib-regularity-defeating-entry-point-checking.figure-2.svg){.fragment .fade-in-then-out fragment-index=2}


:::


### heuristics: library calls  {.smaller}



* dynamic linking --- functions called <em>by name</em>
* how do viruses add to dynamic linking tables? 

   * often don't! --- instead dynamically look-up functions
   * if do --- could mess that up/lots of code

   ![](/heur-detect/texfig/exec-lib-regularity-heuristics-library-calls.figure.svg)


### evading library call checking 


* modify dynamic linking tables 

   * probably tricky to add new entry

* reimplement library call manually 

   * Windows system calls not well documented, change

* [hide names]{.fragment fragment-index=2 .custom .myem-only}


### hiding library call names 


* common approach: store <em>hash of name</em>
* runtime: read library, scan list of functions for name 
<hr class="vspace" />
* bonus: makes analysis harder

