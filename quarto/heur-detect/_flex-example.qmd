
### flex 


* flex is a regular expression matching tool
* intended for writing <em>parsers</em>
* generates <em>C code</em>
* parser function called <code>yylex</code>

### flex example 

```{.flex code-line-numbers=true}
{{< include /heur-detect/flex-example1.l >}}
```
<!-- not using code-line-numbers=|..|.. -->

### flex example


```{.flex code-line-numbers="3,10"}
{{< include /heur-detect/flex-example1.l >}}
```

::: {.myoverbox}
three sections separated by `%%`
:::

### flex example


```{.flex code-line-numbers="1-2"}
{{< include /heur-detect/flex-example1.l >}}
```

::: {.myoverbox style="top: 30%"}
first --- declarations for later C code in output file
:::

### flex example

```{.flex code-line-numbers="4-9"}
{{< include /heur-detect/flex-example1.l >}}
```

::: {.myoverbox style="top: 10%"}
patterns, code to run on match <br />
(when flex is used as parser would return "token" here)
:::

### flex example

```{.flex code-line-numbers="11-16"}
{{< include /heur-detect/flex-example1.l >}}
```

::: {.myoverbox}
extra C code to include
:::



### flex: matched text 



```{.flex code-line-numbers=3}
[aA][a-z]* {
               printf("found a-word '%s'\n", yytext);
           }
(.|\n)     {} /* default rule: would output text */
```

::: {.myoverbox .low}

`yytext` contains contents of currently matched thing

:::

### flex: definitions 

```{.flex code-line-numbers=true}
A        [aA]
LOWERS   [a-z]
ANY      (.|\n)
%%
{A}{LOWERS}* {
                printf("found a-word '%s'\n",
                       yytext);
             }
{ANY}        {} /* default rule would
                   output text */
%%
int main(void) {
    yylex();
}
```

### flex: definitions 

```{.flex code-line-numbers=1-3}
A        [aA]
LOWERS   [a-z]
ANY      (.|\n)
%%
{A}{LOWERS}* {
                printf("found a-word '%s'\n",
                       yytext);
             }
{ANY}        {} /* default rule would
                   output text */
%%
int main(void) {
    yylex();
}
```

::: {.myoverbox .low}

definitions of common patterns included later

:::
