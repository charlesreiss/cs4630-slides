
### on using GDB 


* cheat sheet on website in OVER assignment


### gdb demo 



### trigger segfault  {.smaller}


```
gdb ./a.out
...
(gdb) run <big-input.txt
Starting program: /path/to/a.out 
Program received signal SIGSEGV, Segmentation fault.
0x000000000040053b in vulnerable ()
(gdb) disass
Dump of assembler code for function vulnerable:
   0x0000000000400526 <+0>:     sub    $0x18,%rsp
   0x000000000040052a <+4>:     mov    %rsp,%rdi
   0x000000000040052d <+7>:     mov    $0x0,%eax
   0x0000000000400532 <+12>:    callq  0x400410 <gets@plt>
   0x0000000000400537 <+17>:    add    $0x18,%rsp
=> 0x000000000040053b <+21>:    retq   
End of assembler dump.
(gdb) p $rsp 
$1 = (void *) 0x7fffffffdff8

```


### trigger segfault --- stripped  {.smaller}


```
gdb ./a.out
...
(gdb) run <big-input.txt
Starting program: /path/to/a.out 
Program received signal SIGSEGV, Segmentation fault.
0x000000000040053b in ?? ()
(gdb) disassemble
No function contains program counter for selected frame.
(gdb) x/i $rip
=> 0x40053b:    retq   
(gdb)

```


### stripping 


* you can remove debugging information from executables
* Linux command: <code>strip</code>
* GCC option <code>-s</code>
* <code>disassemble</code> can't tell where function starts


# aside: strip {visibility="hidden"}

### disassembly attempts  {.smaller}


```
gdb ./a.out
...
(gdb) run <big-input.txt
Starting program: /path/to/a.out 
Program received signal SIGSEGV, Segmentation fault.
0x000000000040053b in ?? ()
(gdb) disassemble $rip-5,$rip+1
Dump of assembler code from 0x400536 to 0x40053c:
   0x0000000000400536:  decl   -0x7d(%rax)
   0x0000000000400539:  (bad)  
   0x000000000040053a:  sbb    %al,%bl
End of assembler dump.
(gdb) disassemble $rip-4,$rip+1
Dump of assembler code from 0x400537 to 0x40053c:
   0x0000000000400537:  add    $0x18,%rsp
=> 0x000000000040053b:  retq   
End of assembler dump.
(gdb)

```


### other notable debugger commands 


* <code>b *0x12345</code> --- set breakpoint at address 

   * can set breakpoint on machine code on stack

* watchpoints --- like breakpoints but trigger on change to/read from value 

   * ‘‘when is return address overwritten’’


