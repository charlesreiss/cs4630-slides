
### finding gadgets  {.smaller}


* find code segments of exectuable/library
* look for opcodes of arbitrary jumps: 

   * <code>ret</code>
   * <code>jmp *register</code>
   * <code>jmp *(register)</code>
   * <code>call *register</code>
   * <code>call *(register)</code>

* disassemble starting a few bytes before 

   * invalid instruction? jump before ret? etc. --- discard

* sort list 
<hr class="vspace" />
* <em>automatable</em>


### ROPgadget  {.smaller}



* ROPgadget: tool that does this
 
```
$ ROPgadget --binary /bin/ls
....
0x000000000000f09d : xor r8d, r8d ; cmp rcx, rsi ; jb 0xf0b9 ; jmp 0xf0e6
0x0000000000012a22 : xor r8d, r8d ; jmp 0x11fee
0x0000000000013d86 : xor r8d, r8d ; jmp 0x137a8
0x000000000001421a : xor r8d, r8d ; jmp 0x141b0
0x0000000000006aa1 : xor r8d, r8d ; jmp 0x69d5
0x00000000000099f0 : xor r8d, r8d ; jmp 0x931d
0x000000000000e6d0 : xor r8d, r8d ; mov rax, r8 ; ret
0x00000000000127a7 : xor r8d, r8d ; xor esi, esi ; jmp 0x11fee
0x000000000000e640 : xor r8d, r8d ; xor esi, esi ; jmp 0xe66a
0x000000000001435d : xor r9d, r9d ; jmp 0x141b0
0x0000000000008a03 : xor r9d, r9d ; xor r12d, r12d ; jmp 0x873c
0x0000000000014217 : xor r9d, r9d ; xor r8d, r8d ; jmp 0x141b0

Unique gadgets found: 6472

```


### selected ROP gadget options 


* <code>--offset X</code>: set start location for binray/library
* <code>--badbytes XYZ</code>: ignores gadgets whose addresses contain cerain bytes 

   * to handle restrictions on input --- e.g no newline
   * similar to writing shellcode without specific bytes


