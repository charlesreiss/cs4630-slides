
### programming JOP  {.smaller}

  

::: {.r-stack .my-full style="height: 70%"}
![](/rop/texfig/jopdispatch1.figure-1.svg){.fragment .fade-out fragment-index=2}

![](/rop/texfig/jopdispatch1.figure-2.svg){.fragment .fade-in-then-out fragment-index=2}

![](/rop/texfig/jopdispatch1.figure-3.svg){.fragment .fade-in-then-out fragment-index=3}


:::
 

* setup: find a way to set %rdx, %rdi, %rcx appropriately
* note: can choose different registers, dispatcher design


### dispatcher gadgets?  {.smaller}


```
/* from libc on my desktop: */
adc esi, edi ; jmp qword ptr [rsi + 0xf]
add al, ch ; jmp qword ptr [rax - 0xe]

/* from firefox on my desktop: */
add eax, ebp ; jmp qword ptr [rax]
add edi, -8 ; mov rax, qword ptr [rdi] ; jmp qword ptr [rax + 0x68]
sub esi, dword ptr [rsi] ; jmp qword ptr [rsi - 0x7d]

```
 

* adc (add with carry) --- Intel syntax: destination first

