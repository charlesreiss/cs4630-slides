
### boot process 


::: {.r-stack .my-full}
![](texfig/bootProc.figure-1.svg){.fragment .fade-in-then-out fragment-index=1 fig-alt="Boot process, starting from processor reset. First, the BIOS of EFI is loadeed from a chip on the motherboard.  Then, a bootloader in a fixed location on disk runs, which has the code to figure out where individual files are on disk. This finally loads the operating system code from its files."}

![](texfig/bootProc.figure-2.svg){.fragment .fade-in-then-out fragment-index=2 fig-alt="Boot process, starting from processor reset. First, the BIOS of EFI is loadeed from a chip on the motherboard.  Then, a bootloader in a fixed location on disk runs, which has the code to figure out where individual files are on disk. This finally loads the operating system code from its files."}

![](texfig/bootProc.figure-3.svg){.fragment .fade-in-then-out fragment-index=3 fig-alt="Boot process, starting from processor reset. First, the BIOS of EFI is loadeed from a chip on the motherboard.  Then, a bootloader in a fixed location on disk runs, which has the code to figure out where individual files are on disk. This finally loads the operating system code from its files."}

![](texfig/bootProc.figure-4.svg){.fragment .fade-in-then-out fragment-index=4 fig-alt="Boot process, starting from processor reset. First, the BIOS of EFI is loadeed from a chip on the motherboard.  Then, a bootloader in a fixed location on disk runs, which has the code to figure out where individual files are on disk. This finally loads the operating system code from its files."}

:::


### bootloaders in the DOS era  {.smaller}


* used to be common to boot from floppies
* <em>default to booting from floppy</em> if present 

   * even if hard drive to boot from

* applications distributed as bootable floppies
* so bootloaders on all devices were a target for viruses


### historic bootloader layout  {.smaller}


* bootloader in <em>first sector</em> (512 bytes) of device
* (along with partition information)
* code in BIOS to copy bootloader into RAM, start running
* bootloader responsible for disk I/O etc. 

   * some library-like functionality in BIOS for I/O



### bootloader viruses 

 

* example: Stoned
 
::: {.r-stack}
![](texfig/where-boot-sector-bootloader-viruses.figure-1.svg){.fragment .fade-in-then-out fragment-index=1 fig-alt="The original contents of disk shows a bootloader at the beginning with a partition table in the middle of it. This is transformed to the bootloader being replaced by the virus code (but the partition table is preserved). So the virus can run the original bootloader after it finishes, a copy of the original bootloader is saved elsewhere on disk"}

![](texfig/where-boot-sector-bootloader-viruses.figure-2.svg){.fragment .fade-in-then-out fragment-index=2 fig-alt="The original contents of disk shows a bootloader at the beginning with a partition table in the middle of it. This is transformed to the bootloader being replaced by the virus code (but the partition table is preserved). So the virus can run the original bootloader after it finishes, a copy of the original bootloader is saved elsewhere on disk"}

:::


### data here???  {.smaller}


* might be data there --- risk
* some unused space after partition table/boot loader common 

   * (allegedly)

* also be filesystem metadata not used on smaller floppies/disks 

* but could be wrong --- oops


### modern bootloaders --- UEFI  {.smaller}


* BIOS-based boot is going away (slowly)
* new thing: UEFI (Universal Extensible Firmware Interface)
* like BIOS: 

   * library functionality for bootloaders
   * loads initial code from disk/DVD/etc.

* unlike BIOS: 

   * much more understanding of file systems
   * much more modern set of library calls



### againframe(bootProc)

### BIOS/UEFI implants  {.smaller}


* infrequent
* BIOS/UEFI code is <em>very non-portable</em>
* BIOS/UEFI update may require physical access
* BIOS/UEFI code may require cryptographic signatures
* … but <em>very hard to remove</em> --- ‘‘persist’’ other malware
* reports of BIOS/UEFI-infecting ‘‘implants’’ 

   * sold by Hacking Team (Milan-based malware company)
   * listed in leaked NSA Tailored Access Group catalog



### againframe(bootProc)

### system files  {.smaller}


* simpliest strategy: stuff that runs when you start your computer
* add a new startup program, run in the background 

   * easy to blend in
 

* alternatively, infect one of many system programs automatically run

