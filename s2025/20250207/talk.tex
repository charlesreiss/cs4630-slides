\date{}
\title{}
\date{}
\begin{document}
\begin{frame}
    \titlepage
\end{frame}
\input{../common/listingsLib}
\usetikzlibrary{calc} % FIXME


\begin{frame}{last time}
    \begin{itemize}
    \item RE2 part b strategy
    \item anti-analysis obfuscation
        \begin{itemize}
        \item `generating' strings to make them less searchable
        \item `hiding' functions through merge/split
        \item `hiding' flow-control through switch statement loop
        \end{itemize}
    \item anti-signature techniques
        \begin{itemize}
        \item ``encrypted'' code
        \end{itemize}
    \end{itemize}
\end{frame}

\begin{frame}[fragile]{note re: encodeliterals}
    \begin{itemize}
    \item showed decompiled code like:
    \end{itemize}
\begin{Verbatim}[fontsize=\small]
*((int*) param_1)[0] = 0x736579;
\end{Verbatim}
    \begin{itemize}
    \item if you tell Ghidra \texttt{param\_1} is a char*:
    \end{itemize}
\begin{Verbatim}[fontsize=\small]
builtin_strcpy(param_1, "yes");
\end{Verbatim}
\end{frame}

\begin{frame}{aside: other obfusction ideas}
    \begin{itemize}
    \item (mentioned) useless additional if statements/function calls
    \item checking hash of machine code periodically
    \item modifying machine code at run time
    \item running the program in a custom (JVM-esque) interpreter
        \begin{itemize}
        \item will give example later
        \item converting code to data
        \end{itemize}
    \end{itemize}
\end{frame}

\subsection{decrypter variations}
\input{../antianti/decrypter-variants}

\section{metamorphic, etc. idea}
\input{../antianti/metamorphic-play-mouse}

\section{oligomorphic viruses}
\againframe<2>{playMouse}
\input{../antianti/olig}

\subsection{case study: W95/Memorial}
\input{../antianti/w95memorial}

\section{polymorphic viruses}
\input{../antianti/poly-intro}

\subsection{case study: 1260}
\input{../antianti/1260}

\subsection{more generic mutation}
\input{../antianti/mutation-engine-generic}

\section{terminology: packers}
\input{../antianti/packers}

\section{anti-packer strategies} % FIXME: move earlier?
\subsection{generic anti-packers}
\input{../antianti/packer-detect}


\section{emulators}
\subsection{example: unicorn}
\input{../re-tools/emu}

\subsection{unipacker pseudcode}
\input{../antianti/unipacker-pseudo}

\subsection{example: Qiling}
\input{../re-tools/qiling}
\subsection{example: PANDA-RE}
\input{../re-tools/panda-re}

\subsection{aside: instruction traces}
\input{../antianti/instr-traces}

\section{anti-virtualization strategies}
\subsection{basic issues}
\input{../antianti/antivm-intro}

\subsection{automated analysis: lack of patience?}
\input{../antianti/antivm-patience}

\section{packer issues}
\subsection{packers and W xor X/DEP}
\input{../antianti/packers-and-depwx}

\subsection{exercise: limitations of generic anti-packer}
\input{../antianti/packer-detect-limit-ex}

\section{metamorphic viruses}
     %FIXME: not very clear
\input{../antianti/meta-intro}

\subsection{example: changing bodies}
\input{../antianti/meta-body-change-example}

\subsection{case study: Evol}
\input{../antianti/evol}

\subsection{handling relocation with mutation}
\input{../antianti/mutate-reloc}

\subsection{fancy mutation engines}
\input{../antianti/fancy-mutation-engine}

\section{goats and anti-goat}
\input{../antianti/goat}

\section{anti-debugging}
\input{../antianti/antidebug-intro}

\subsection{breaking breakpoints}
\againframe<2>{debuggerThings}

\input{../antianti/antidebug-breakpt-int3}

\subsubsection{aside: modern breakpoints}
\input{../antianti/debug-modern-breakpt}

\subsection{breaking single-stepping (short)}
\againframe<3>{debuggerThings}
\input{../antianti/antidebug-ss}

\section{emulation-based obfuscation}
\input{../antianti/emulate-obfuscate}

\section{retroviruses / direct antiantivirus}
\input{../antianti/retro}

\subsection{hiding}
\input{../antianti/stealth}

\subsection{chkrootkit}
\input{../antianti/chkrootkit}


\section{backup slides}
\begin{frame}{backup slides}
\end{frame}

\subsection{heuristics to find packers}
\input{../antianti/packer-detect}

\subsection{rootkits and chkrootkit}
\input{../antianti/chkrootkit}

\subsection{aside: disinfection}
\input{../heur-detect/aside-disinfect} % FIXME: clamav example?


\subsection{signatures and extracting encryptd code?}
\input{../antianti/encrypted-code-sigs-analyze}


\section{backup slides}
\begin{frame}{backup slides}
\end{frame}

\input{../antianti/talk-backup}

\end{document}
